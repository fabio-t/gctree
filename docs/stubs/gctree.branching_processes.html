

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>gctree.branching_processes &mdash; gctree  documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="gctree.branching_processes.CollapsedForest" href="gctree.branching_processes.CollapsedForest.html" />
    <link rel="prev" title="Modules" href="../api.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html">
          

          
            
            <img src="../_static/logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cite.html">Citing gctree</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">Quickstart</a></li>
</ul>
<p class="caption"><span class="caption-text">CLI Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../cli.html">gctree</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cli.html#parsimony-utilities">Parsimony utilities</a></li>
</ul>
<p class="caption"><span class="caption-text">API Documentation</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../api.html">Modules</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">gctree.branching_processes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="gctree.branching_processes.CollapsedForest.html">gctree.branching_processes.CollapsedForest</a></li>
<li class="toctree-l3"><a class="reference internal" href="gctree.branching_processes.CollapsedTree.html">gctree.branching_processes.CollapsedTree</a></li>
<li class="toctree-l3"><a class="reference internal" href="gctree.branching_processes.LeavesAndClades.html">gctree.branching_processes.LeavesAndClades</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="gctree.mutation_model.html">gctree.mutation_model</a></li>
<li class="toctree-l2"><a class="reference internal" href="gctree.utils.html">gctree.utils</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Developer Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../developer.html">Open source code repository</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer.html#developer-tools">Developer tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer.html#todo-list">Todo list</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">gctree</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../api.html">Modules</a> &raquo;</li>
        
      <li>gctree.branching_processes</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-gctree.branching_processes">
<span id="gctree-branching-processes"></span><h1>gctree.branching_processes<a class="headerlink" href="#module-gctree.branching_processes" title="Permalink to this headline">¶</a></h1>
<p>This module contains classes for simulation and inference for a binary
branching process with mutation in which the tree is collapsed to nodes that
count the number of clonal leaves of each type.</p>
<p class="rubric">Classes</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="gctree.branching_processes.CollapsedForest.html#gctree.branching_processes.CollapsedForest" title="gctree.branching_processes.CollapsedForest"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CollapsedForest</span></code></a></p></td>
<td><p>simply a set of CollapsedTrees, with the same p and q parameters</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="gctree.branching_processes.CollapsedTree.html#gctree.branching_processes.CollapsedTree" title="gctree.branching_processes.CollapsedTree"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CollapsedTree</span></code></a></p></td>
<td><p>Here’s a derived class for a collapsed tree, where we recurse into the mutant clades       (4)      / | \    (3)(1)(2)        |   \       (2)  (1)</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="gctree.branching_processes.LeavesAndClades.html#gctree.branching_processes.LeavesAndClades" title="gctree.branching_processes.LeavesAndClades"><code class="xref py py-obj docutils literal notranslate"><span class="pre">LeavesAndClades</span></code></a></p></td>
<td><p>This is a base class for simulating, and computing likelihood for, an infinite type branching process with branching probability p, mutation probability q, and we collapse mutant clades off the root type and consider just the number of clone leaves, c, and mutant clades, m.</p></td>
</tr>
</tbody>
</table>
<dl class="py class">
<dt class="sig sig-object py" id="gctree.branching_processes.LeavesAndClades">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">gctree.branching_processes.</span></span><span class="sig-name descname"><span class="pre">LeavesAndClades</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gctree/branching_processes.html#LeavesAndClades"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gctree.branching_processes.LeavesAndClades" title="Permalink to this definition">¶</a></dt>
<dd><p>This is a base class for simulating, and computing likelihood for, an
infinite type branching process with branching probability p, mutation
probability q, and we collapse mutant clades off the root type and consider
just the number of clone leaves, c, and mutant clades, m.</p>
<blockquote>
<div><blockquote>
<div><p>/</p>
</div></blockquote>
<dl class="simple">
<dt>/^          (3)</dt><dd><dl class="simple">
<dt>/    ==&gt;   / \</dt><dd><dl class="simple">
<dt>/\</dt><dd><p>^</p>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
</div></blockquote>
<p>initialize with branching probability p and mutation probability q,
both in the unit interval.</p>
<dl class="py method">
<dt class="sig sig-object py" id="gctree.branching_processes.LeavesAndClades.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gctree/branching_processes.html#LeavesAndClades.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gctree.branching_processes.LeavesAndClades.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>initialize with branching probability p and mutation probability q,
both in the unit interval.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gctree.branching_processes.LeavesAndClades.simulate">
<span class="sig-name descname"><span class="pre">simulate</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gctree/branching_processes.html#LeavesAndClades.simulate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gctree.branching_processes.LeavesAndClades.simulate" title="Permalink to this definition">¶</a></dt>
<dd><p>simulate the number of clone leaves and mutant clades off a root
node.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gctree.branching_processes.LeavesAndClades.logf">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">logf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gctree/branching_processes.html#LeavesAndClades.logf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gctree.branching_processes.LeavesAndClades.logf" title="Permalink to this definition">¶</a></dt>
<dd><p>Log-probability of getting c leaves that are clones of the root and
m mutant clades off the root lineage, given branching probability p and
mutation probability q.</p>
<p>AKA the spaceship distribution. Also returns gradient wrt params
(p, q). Computed by dynamic programming.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gctree.branching_processes.LeavesAndClades.build_logf_cache">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">build_logf_cache</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">c_max</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m_max</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gctree/branching_processes.html#LeavesAndClades.build_logf_cache"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gctree.branching_processes.LeavesAndClades.build_logf_cache" title="Permalink to this definition">¶</a></dt>
<dd><p>build up the lru_cache from the bottom to avoid recursion depth
issues.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="gctree.branching_processes.CollapsedTree">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">gctree.branching_processes.</span></span><span class="sig-name descname"><span class="pre">CollapsedTree</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tree</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">collapse_syn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_repeats</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gctree/branching_processes.html#CollapsedTree"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gctree.branching_processes.CollapsedTree" title="Permalink to this definition">¶</a></dt>
<dd><p>Here’s a derived class for a collapsed tree, where we recurse into the
mutant clades</p>
<blockquote>
<div><blockquote>
<div><blockquote>
<div><ol class="arabic simple" start="4">
<li></li>
</ol>
</div></blockquote>
<p>/ | \</p>
</div></blockquote>
<dl>
<dt>(3)(1)(2)</dt><dd><blockquote>
<div><div class="line-block">
<div class="line">\</div>
</div>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><ol class="arabic simple">
<li></li>
</ol>
</li>
</ol>
</dd>
</dl>
</div></blockquote>
<p>For intialization, either params or tree (or both) must be provided
params: offspring distribution parameters
tree: ete tree with frequency node feature. If uncollapsed, it will be
collapsed
frame: tranlation frame, with default None, no tranlation attempted</p>
<dl class="py method">
<dt class="sig sig-object py" id="gctree.branching_processes.CollapsedTree.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tree</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">collapse_syn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_repeats</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gctree/branching_processes.html#CollapsedTree.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gctree.branching_processes.CollapsedTree.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>For intialization, either params or tree (or both) must be provided
params: offspring distribution parameters
tree: ete tree with frequency node feature. If uncollapsed, it will be
collapsed
frame: tranlation frame, with default None, no tranlation attempted</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gctree.branching_processes.CollapsedTree.ll">
<span class="sig-name descname"><span class="pre">ll</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sign</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_cache</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gctree/branching_processes.html#CollapsedTree.ll"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gctree.branching_processes.CollapsedTree.ll" title="Permalink to this definition">¶</a></dt>
<dd><p>log likelihood of params, conditioned on collapsed tree, and its
gradient wrt params optional parameter sign must be 1 or -1, with the
latter useful for MLE by minimization.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gctree.branching_processes.CollapsedTree.mle">
<span class="sig-name descname"><span class="pre">mle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gctree/branching_processes.html#CollapsedTree.mle"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gctree.branching_processes.CollapsedTree.mle" title="Permalink to this definition">¶</a></dt>
<dd><p>Maximum likelihood estimate for params given tree updates params if
not None returns optimization result.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gctree.branching_processes.CollapsedTree.simulate">
<span class="sig-name descname"><span class="pre">simulate</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gctree/branching_processes.html#CollapsedTree.simulate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gctree.branching_processes.CollapsedTree.simulate" title="Permalink to this definition">¶</a></dt>
<dd><p>simulate a collapsed tree given params replaces existing tree data
member with simulation result, and returns self.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gctree.branching_processes.CollapsedTree.render">
<span class="sig-name descname"><span class="pre">render</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">outfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idlabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colormap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_support</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chain_split</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gctree/branching_processes.html#CollapsedTree.render"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gctree.branching_processes.CollapsedTree.render" title="Permalink to this definition">¶</a></dt>
<dd><p>render to image file, filetype inferred from suffix, svg for color
images.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gctree.branching_processes.CollapsedTree.write">
<span class="sig-name descname"><span class="pre">write</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gctree/branching_processes.html#CollapsedTree.write"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gctree.branching_processes.CollapsedTree.write" title="Permalink to this definition">¶</a></dt>
<dd><p>serialize tree to file.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gctree.branching_processes.CollapsedTree.newick">
<span class="sig-name descname"><span class="pre">newick</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gctree/branching_processes.html#CollapsedTree.newick"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gctree.branching_processes.CollapsedTree.newick" title="Permalink to this definition">¶</a></dt>
<dd><p>write to newick file.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gctree.branching_processes.CollapsedTree.compare">
<span class="sig-name descname"><span class="pre">compare</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tree2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'identity'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gctree/branching_processes.html#CollapsedTree.compare"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gctree.branching_processes.CollapsedTree.compare" title="Permalink to this definition">¶</a></dt>
<dd><p>compare this tree to the other tree.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gctree.branching_processes.CollapsedTree.get_split">
<span class="sig-name descname"><span class="pre">get_split</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gctree/branching_processes.html#CollapsedTree.get_split"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gctree.branching_processes.CollapsedTree.get_split" title="Permalink to this definition">¶</a></dt>
<dd><p>return the bipartition resulting from clipping this node’s edge
above.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gctree.branching_processes.CollapsedTree.support">
<span class="sig-name descname"><span class="pre">support</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bootstrap_trees_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compatibility</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gctree/branching_processes.html#CollapsedTree.support"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gctree.branching_processes.CollapsedTree.support" title="Permalink to this definition">¶</a></dt>
<dd><p>compute support from a list of bootstrap gctrees weights (optional)
is needed for weighting parsimony degenerate trees compatibility mode
counts trees that don’t disconfirm the split.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="gctree.branching_processes.CollapsedForest">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">gctree.branching_processes.</span></span><span class="sig-name descname"><span class="pre">CollapsedForest</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_trees</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">forest</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gctree/branching_processes.html#CollapsedForest"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gctree.branching_processes.CollapsedForest" title="Permalink to this definition">¶</a></dt>
<dd><dl>
<dt>simply a set of CollapsedTrees, with the same p and q parameters</dt><dd><blockquote>
<div><ol class="arabic simple" start="4">
<li><ol class="arabic simple" start="3">
<li></li>
</ol>
</li>
</ol>
</div></blockquote>
<p>/ | \         / \</p>
</dd>
<dt>(3)(1)(2)     (1) (2)</dt><dd><blockquote>
<div><div class="line-block">
<div class="line">\  ,          , …</div>
</div>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><ol class="arabic simple">
<li></li>
</ol>
</li>
</ol>
</dd>
</dl>
<p>in addition to p and q, we need number of trees can also intialize
with forest, a list of trees, each an instance of CollapsedTree.</p>
<dl class="py method">
<dt class="sig sig-object py" id="gctree.branching_processes.CollapsedForest.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_trees</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">forest</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gctree/branching_processes.html#CollapsedForest.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gctree.branching_processes.CollapsedForest.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>in addition to p and q, we need number of trees can also intialize
with forest, a list of trees, each an instance of CollapsedTree.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gctree.branching_processes.CollapsedForest.simulate">
<span class="sig-name descname"><span class="pre">simulate</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gctree/branching_processes.html#CollapsedForest.simulate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gctree.branching_processes.CollapsedForest.simulate" title="Permalink to this definition">¶</a></dt>
<dd><p>simulate a forest of collapsed trees given params and number of
trees replaces existing forest data member with simulation result, and
returns self.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gctree.branching_processes.CollapsedForest.ll">
<span class="sig-name descname"><span class="pre">ll</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sign</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">empirical_bayes_sum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_cache</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gctree/branching_processes.html#CollapsedForest.ll"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gctree.branching_processes.CollapsedForest.ll" title="Permalink to this definition">¶</a></dt>
<dd><p>likelihood of params, given forest, and it’s gradient wrt params
optional parameter sign must be 1 or -1, with the latter useful for MLE
by minimization if optional parameter empirical_bayes_sum is true,
we’re estimating params for a set of parsimony trees.</p>
</dd></dl>

</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="gctree.branching_processes.CollapsedForest.html" class="btn btn-neutral float-right" title="gctree.branching_processes.CollapsedForest" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="../api.html" class="btn btn-neutral float-left" title="Modules" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2020, William DeWitt.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>