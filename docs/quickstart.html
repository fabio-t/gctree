

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Quickstart &mdash; gctree  documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="gctree" href="cli.html" />
    <link rel="prev" title="Citing gctree" href="cite.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html">
          

          
            
            <img src="_static/logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">User Guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="cite.html">Citing gctree</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Quickstart</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#input-data">Input data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#deduplication-and-sequence-abundances">Deduplication and sequence abundances</a></li>
<li class="toctree-l2"><a class="reference internal" href="#parsimony-trees">Parsimony trees</a></li>
<li class="toctree-l2"><a class="reference internal" href="#gctree">gctree</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">CLI Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="cli.html">gctree</a></li>
<li class="toctree-l1"><a class="reference internal" href="cli.html#parsimony-utilities">Parsimony utilities</a></li>
</ul>
<p class="caption"><span class="caption-text">API Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="api.html">Modules</a></li>
</ul>
<p class="caption"><span class="caption-text">Developer Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="developer.html">Open source code repository</a></li>
<li class="toctree-l1"><a class="reference internal" href="developer.html#developer-tools">Developer tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="developer.html#todo-list">Todo list</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">gctree</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Quickstart</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="quickstart">
<h1>Quickstart<a class="headerlink" href="#quickstart" title="Permalink to this headline">¶</a></h1>
<p>In this minimal example we show how to use gctree commands to rank parsimony trees from PHYLIP’s dnapars program.
See the CLI and API docs for complete documentation of command options, included many not used here.</p>
<p>The data in this example were published in <a class="reference external" href="http://science.sciencemag.org/content/351/6277/1048">Tas et al. 2016. Visualizing Antibody Affinity Maturation in Germinal Centers. Science 351 (6277)</a> and shown in Fig. 4 (lymph node 2, germinal center 1).</p>
<a class="reference internal image-reference" href="_images/gc1.png"><img alt="_images/gc1.png" src="_images/gc1.png" style="width: 200px;" /></a>
<div class="section" id="input-data">
<h2>Input data<a class="headerlink" href="#input-data" title="Permalink to this headline">¶</a></h2>
<p>We start with a fasta alignment file.
From the <code class="docutils literal notranslate"><span class="pre">example/</span></code> directory, the file <code class="docutils literal notranslate"><span class="pre">150228_Clone_3-8.fasta</span></code> contains heavy chain V gene sequences from
germinal B cells sorted from a brainbow mouse using multicolor fate mapping.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>$ tail -30 150228_Clone_3-8.fasta
&gt;VIBM1S4H08IgG
ggacctagcctcgtgaaaccttctcagactctgtccctcacctgttctgtcactggcgac
tccatcaccagtggttactggaactggatccggaagttcccagggaatagacttgagtac
atggggtacataagcttcagtggtagcacttactacaatccatctctcaaaagtcgaatc
tccatcactcgagacacatccaagaaccagtactacctgcagttgaattctgtgactact
gaagacacagccacatattactgt
&gt;VIBM1S4H09IgG
ggacctagcctcgtgaaaccttctcagactctgtccctcacctgttctgtcactggcgac
tccatcaccagtggttactggaactggatccggaagttcccagggaatagacttgagtac
atggggtacataagcttcagtggtggcacttactacaatccatctctcaaaagtcgaatc
tccatcactcgagacacatccgagaaccagtactacctgcagttgaattctgtgactact
gaggacacagccacatattactgt
&gt;VIBM1S4H12IgG
ggacctagcctcgtaaaaccttctcagactctgtccctcacctgttctgtcactggcgac
tccatcaccagtggttactggaactggatccggaagttcccagggaatagacttgagtac
atggggtacataagcttcagtggtagcacttactacaatccatctctcaaaagtcgaatc
tccatcactcgagacacatccaagaaccagtactacctgcagttgaattctgtgactact
gaggacacagccacatattactgt
&gt;17
ggacctagcctcgtgaaaccttctcagactctgtccctcacctgttctgtcactggcgac
tccatcaccagtggttactggaactggatccggaagttcccagggaatagacttgagtac
atggggtacataagcttcagtggtagcacttactacaatccatctctcaaaagtcgaatc
tccatcactcgagacacatccaagaaccagtactacctgcagttgaattctgtgactact
gaggacacagccacatattactgt
&gt;GL
ggacctagcctcgtgaaaccttctcagactctgtccctcacctgttctgtcactggcgac
tccatcaccagtggttactggaactggatccggaaattcccagggaataaacttgagtac
atggggtacataagctacagtggtagcacttactacaatccatctctcaaaagtcgaatc
tccatcactcgagacacatccaagaaccagtactacctgcagttgaattctgtgactact
gaggacacagccacatattactgt
</pre></div>
</div>
<p>In this file the sequence with id <code class="docutils literal notranslate"><span class="pre">GL</span></code> is the naive germline sequence, and represents the root of the tree.
It does not refer to an observed sequence, but is included to outgroup root the tree!
Generally this input fasta file should also contain all observed sequences with duplication (some of which may be identical to the root/outgroup sequence).
It is also possible to provide some observed sequences with integers ids to be interpreted as abundances, as in the sequence named <code class="docutils literal notranslate"><span class="pre">17</span></code> above.</p>
</div>
<div class="section" id="deduplication-and-sequence-abundances">
<h2>Deduplication and sequence abundances<a class="headerlink" href="#deduplication-and-sequence-abundances" title="Permalink to this headline">¶</a></h2>
<p>First we deduplicate the sequences and convert to phylip alignment format, and also determine sequence abundances.
The <code class="docutils literal notranslate"><span class="pre">deduplicate</span></code> command writes the phylip alignment of unique sequences to stdout (which we redirect to a file here).
The argument <code class="docutils literal notranslate"><span class="pre">--root</span></code> indicates the root id.
The flag <code class="docutils literal notranslate"><span class="pre">--id_abundances</span></code> indicates that integer sequence ids should be interepreted as abundances (our <code class="docutils literal notranslate"><span class="pre">17</span></code> sequence).
The argument <code class="docutils literal notranslate"><span class="pre">--abundance_file</span></code> indicates that sequence abundance information should be written to the specified <code class="docutils literal notranslate"><span class="pre">csv</span></code> file.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>$ deduplicate 150228_Clone_3-8.fasta --root GL --id_abundances --abundance_file abundances.csv &gt; deduplicated.phylip
</pre></div>
</div>
<p>We now have files <code class="docutils literal notranslate"><span class="pre">deduplicated.phylip</span></code> and <code class="docutils literal notranslate"><span class="pre">abundances.csv</span></code>:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>$ head deduplicated.phylip
 43 264
GL         ggacctagcc tcgtgaaacc ttctcagact ctgtccctca cctgttctgt
seq1       ggacctagcc tcgtgaaacc ttctcagact ctgtccctca cctgttctgt
seq2       ggacctagcc tcgtgaaacc ttctcagact ctgtccctca cctgttctgt
seq3       ggacctagcc tcgtgaaacc ttctcagact ctgtccctca cctgttctgt
seq4       ggacctagcc tcgtgaaacc ttctcagact ctgtccctca cctgttctgt
seq5       ggacctagcc tcgtgaaacc ttctcagact ctgtccctca cctgttctgt
seq6       ggacctagcc tcgtgaaacc ttctcagact ctgtccctca cctgttctgt
seq7       ggacctagcc tcgtgaaatc ttctcagact ctgtccctca cctgttctgt
seq8       ggacctagcc tcgtgaaacc ttctcagact ctgtccctca cctgttctgt
</pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>$ head abundances.csv
GL,0
seq1,1
seq2,1
seq3,1
seq4,1
seq5,1
seq6,1
seq7,1
seq8,1
seq9,3
</pre></div>
</div>
</div>
<div class="section" id="parsimony-trees">
<h2>Parsimony trees<a class="headerlink" href="#parsimony-trees" title="Permalink to this headline">¶</a></h2>
<p>We use PHYLIP’s <code class="docutils literal notranslate"><span class="pre">dnapars</span></code> program (see install docs page) to generate a set of maximum parsimony trees for the deduplicated sequences.
PHYLIP is an interactive command line tool, so we will automatically generate a config file to feed it input, instead of using it interactively.</p>
<p>We generate a config file for <code class="docutils literal notranslate"><span class="pre">dnapars</span></code> based on our deduplicated alignment using the <code class="docutils literal notranslate"><span class="pre">mkconfig</span></code> command.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>$ mkconfig deduplicated.phylip dnapars &gt; dnapars.cfg
</pre></div>
</div>
<p>Run <code class="docutils literal notranslate"><span class="pre">dnapars</span></code> using this config file, redirecting stdout to a log file.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>$ dnapars &lt; dnapars.cfg &gt; dnapars.log
</pre></div>
</div>
<p>You now have two new files, <code class="docutils literal notranslate"><span class="pre">outfile</span></code> and <code class="docutils literal notranslate"><span class="pre">outtree</span></code>.
Note: if you want to rerun the above <code class="docutils literal notranslate"><span class="pre">dnapars</span></code> command, you must delete these two files first!</p>
</div>
<div class="section" id="gctree">
<h2>gctree<a class="headerlink" href="#gctree" title="Permalink to this headline">¶</a></h2>
<p>We’re now ready to run <code class="docutils literal notranslate"><span class="pre">gctree</span> <span class="pre">infer</span></code> to use abundance data (in <code class="docutils literal notranslate"><span class="pre">abundances.csv</span></code>) to rank the eqaully parsimonious trees (in <code class="docutils literal notranslate"><span class="pre">outfile</span></code>).</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>$ gctree infer outfile abundances.csv --root GL
/Users/williamdewitt/Desktop/repos.nosync/gctree/gctree/branching_processes.py:373: RuntimeWarning: gradient mismatches finite difference approximation by 591756.2709373797
  warnings.warn(
number of trees with integer branch lengths: 207
207 trees exhibit unobserved unifurcation from root. Adding psuedocounts to these roots
params = [0.4961832061114772, 0.3656706398045132]
tree	alleles	logLikelihood
1	48	-78.00634418534649
2	48	-79.82079119484135
3	48	-79.82079119484135
4	48	-79.82079119484135
...
</pre></div>
</div>
<p>The information printed to stdout (truncated above) shows a list of parsimony trees ranked by decreasing gctree log-likelihood.
A large number of output files with the basename <code class="docutils literal notranslate"><span class="pre">gctree.out.</span></code> are also created.
The SVG image file <code class="docutils literal notranslate"><span class="pre">gctree.out.inference.abundance_rank.svg</span></code> shows a distribution of genotype abundances in the original data:</p>
<a class="reference internal image-reference" href="_images/gctree.out.inference.abundance_rank.svg"><img alt="_images/gctree.out.inference.abundance_rank.svg" src="_images/gctree.out.inference.abundance_rank.svg" width="600" /></a>
<p>The SVG image file <code class="docutils literal notranslate"><span class="pre">gctree.out.inference.likelihood_rank.svg</span></code> is a rank plot of these likelihoods over the set of maximum parsimony trees:</p>
<a class="reference internal image-reference" href="_images/gctree.out.inference.likelihood_rank.svg"><img alt="_images/gctree.out.inference.likelihood_rank.svg" src="_images/gctree.out.inference.likelihood_rank.svg" width="600" /></a>
<p>Then there are files <code class="docutils literal notranslate"><span class="pre">gctree.out.inference.[1,2,...].svg</span></code> and <code class="docutils literal notranslate"><span class="pre">gctree.out.inference.[1,2,...].nk</span></code> containing an SVG tree image and newick tree file for each of the parsimony trees (numbered according to likelihood rank).
For example here is the top ranked tree <code class="docutils literal notranslate"><span class="pre">gctree.out.inference.1.svg</span></code>:</p>
<a class="reference internal image-reference" href="_images/gctree.out.inference.1.svg"><img alt="_images/gctree.out.inference.1.svg" src="_images/gctree.out.inference.1.svg" width="600" /></a>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="cli.html" class="btn btn-neutral float-right" title="gctree" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="cite.html" class="btn btn-neutral float-left" title="Citing gctree" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2020, William DeWitt.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>